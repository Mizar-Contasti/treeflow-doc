---
sidebar_position: 6
---

# üåê LocalTunnel para Desarrollo

LocalTunnel es una herramienta que permite exponer tu aplicaci√≥n TreeFlow local a internet con URLs p√∫blicas, ideal para demos, testing y desarrollo colaborativo.

{/* ![LocalTunnel Diagram](/img/localtunnel-diagram-placeholder.svg) */}

## ¬øQu√© es LocalTunnel?

LocalTunnel crea un t√∫nel seguro entre tu m√°quina local y un servidor p√∫blico, permitiendo que cualquier persona con la URL pueda acceder a tu aplicaci√≥n sin necesidad de configurar routers, firewalls o servicios en la nube.

### Caracter√≠sticas Principales

- ‚úÖ **100% Gratuito**: Sin l√≠mites de tr√°fico o tiempo
- ‚úÖ **HTTPS Autom√°tico**: Certificados SSL incluidos
- ‚úÖ **Subdominios Personalizados**: Elige tu propio nombre
- ‚úÖ **M√∫ltiples T√∫neles**: Expone varios servicios simult√°neamente
- ‚úÖ **Sin Configuraci√≥n**: Funciona sin abrir puertos en tu router

## Instalaci√≥n

LocalTunnel requiere Node.js instalado en tu sistema.

```bash
# Instalar globalmente
npm install -g localtunnel
```

## Uso B√°sico

### Exponer un Solo Servicio

```bash
# Exponer puerto 3000 (frontend)
lt --port 3000

# Con subdominio personalizado
lt --port 3000 --subdomain treeflow-app
```

Resultado:
```
your url is: https://treeflow-app.loca.lt
```

## Configuraci√≥n para TreeFlow

TreeFlow tiene 3 servicios que necesitan ser expuestos:

### 1. Frontend (Puerto 3000)

```bash
# Terminal 1
lt --port 3000 --subdomain treeflow-app
```

**URL resultante**: `https://treeflow-app.loca.lt`

### 2. Backend (Puerto 8000)

```bash
# Terminal 2
lt --port 8000 --subdomain treeflow-api
```

**URL resultante**: `https://treeflow-api.loca.lt`

### 3. Generative AI (Puerto 8001)

```bash
# Terminal 3
lt --port 8001 --subdomain treeflow-ai
```

**URL resultante**: `https://treeflow-ai.loca.lt`

## Configuraci√≥n del Frontend

Una vez que tengas las URLs de LocalTunnel, necesitas configurar el frontend para que apunte a ellas.

### Actualizar docker-compose.yml

```yaml
frontend:
  build:
    context: .
    dockerfile: Dockerfile.frontend
    args:
      - VITE_API_URL=https://treeflow-api.loca.lt
      - VITE_GENERATIVE_API_URL=https://treeflow-ai.loca.lt
  ports:
    - "3000:80"
```

### Rebuild el Frontend

```bash
# Rebuild solo el frontend
docker-compose build --no-cache frontend

# Reiniciar el contenedor
docker-compose up -d frontend
```

## Bypass de Autenticaci√≥n

LocalTunnel muestra una p√°gina de advertencia la primera vez que alguien accede. TreeFlow v0.4 incluye bypass autom√°tico mediante headers.

### Implementaci√≥n Autom√°tica

El bypass est√° implementado en:

**Frontend (client.ts)**:
```typescript
client.interceptors.request.use((config) => {
  // Bypass LocalTunnel reminder page
  if (config.headers) {
    config.headers['Bypass-Tunnel-Reminder'] = 'true';
  }
  return config;
});
```

**Generative (useReforestacion.ts)**:
```typescript
const response = await fetch(`${API_BASE_URL}/api/reforestacion/preview`, {
  headers: {
    'Bypass-Tunnel-Reminder': 'true'
  }
});
```

:::tip Bypass Autom√°tico
Con TreeFlow v0.4, el bypass est√° configurado autom√°ticamente. No necesitas hacer nada adicional.
:::

## Flujo Completo

### 1. Iniciar TreeFlow

```bash
# En el directorio de TreeFlow
docker-compose up
```

### 2. Iniciar T√∫neles

Abre 3 terminales y ejecuta:

```bash
# Terminal 1: Frontend
lt --port 3000 --subdomain treeflow-app

# Terminal 2: Backend
lt --port 8000 --subdomain treeflow-api

# Terminal 3: Generative
lt --port 8001 --subdomain treeflow-ai
```

### 3. Configurar URLs

Actualiza `docker-compose.yml` con las URLs de LocalTunnel y rebuild el frontend.

### 4. Acceder

Abre tu navegador y visita:
```
https://treeflow-app.loca.lt
```

{/* ![LocalTunnel Flow](/img/localtunnel-flow-placeholder.svg) */}

## Casos de Uso

### üéØ Demos y Presentaciones

Muestra tu bot a clientes o stakeholders sin necesidad de desplegar en producci√≥n.

```bash
# T√∫nel temporal para demo
lt --port 3000 --subdomain demo-cliente-xyz
```

### üë• Desarrollo Colaborativo

Permite que tu equipo pruebe cambios en tiempo real.

```bash
# T√∫nel para equipo de QA
lt --port 3000 --subdomain treeflow-qa
```

### üì± Testing en Dispositivos M√≥viles

Prueba tu bot en diferentes dispositivos sin configuraci√≥n adicional.

```bash
# Accede desde tu m√≥vil
https://treeflow-app.loca.lt
```

### üîó Webhooks y Integraciones

Prueba webhooks que requieren URLs p√∫blicas.

```bash
# URL para webhook
https://treeflow-api.loca.lt/webhooks/callback
```

## Consideraciones

### ‚ö†Ô∏è Seguridad

- LocalTunnel expone tu aplicaci√≥n local a internet
- Cualquiera con la URL puede acceder
- Usa subdominios √∫nicos para evitar colisiones
- No uses en producci√≥n

### üíª Rendimiento

- La velocidad depende de tu conexi√≥n a internet
- El upload de tu internet afecta la experiencia del usuario
- LocalTunnel agrega latencia adicional (~50-200ms)

### üîå Disponibilidad

- Tu PC debe estar encendido y conectado
- Si cierras la terminal, el t√∫nel se cierra
- Si tu internet se cae, el t√∫nel se desconecta

## Alternativas

Si LocalTunnel no funciona para tu caso de uso, considera:

### ngrok (M√°s Estable)

```bash
# Instalar ngrok
# https://ngrok.com/download

# Exponer puerto
ngrok http 3000
```

**Ventajas**:
- M√°s estable
- Dashboard con analytics
- Replay de requests

**Desventajas**:
- Solo 1 t√∫nel gratis
- L√≠mite de 40 req/min

### Serveo (SSH)

```bash
# Sin instalaci√≥n (usa SSH)
ssh -R treeflow:80:localhost:3000 serveo.net
```

**Ventajas**:
- Sin instalaci√≥n
- Usa SSH nativo

**Desventajas**:
- Menos estable
- Sin dashboard

## Troubleshooting

### Problema: "Subdomain already in use"

**Soluci√≥n**: Usa un subdominio diferente

```bash
lt --port 3000 --subdomain treeflow-app-2024
```

### Problema: "Connection refused"

**Soluci√≥n**: Verifica que Docker est√© corriendo

```bash
docker-compose ps
```

### Problema: "Tunnel closed"

**Soluci√≥n**: Reinicia el t√∫nel

```bash
# Ctrl+C para cerrar
# Volver a ejecutar
lt --port 3000 --subdomain treeflow-app
```

### Problema: "502 Bad Gateway"

**Soluci√≥n**: Verifica que el servicio est√© respondiendo

```bash
# Probar localmente primero
curl http://localhost:3000
```

## Mejores Pr√°cticas

### ‚úÖ Usa Subdominios Descriptivos

```bash
# ‚ùå Evita
lt --port 3000

# ‚úÖ Mejor
lt --port 3000 --subdomain treeflow-demo-cliente
```

### ‚úÖ Mant√©n las Terminales Organizadas

Usa nombres claros en tus terminales:
- Terminal 1: "LocalTunnel - Frontend"
- Terminal 2: "LocalTunnel - Backend"
- Terminal 3: "LocalTunnel - Generative"

### ‚úÖ Documenta las URLs

Guarda las URLs en un archivo para referencia:

```bash
# urls.txt
Frontend:   https://treeflow-app.loca.lt
Backend:    https://treeflow-api.loca.lt
Generative: https://treeflow-ai.loca.lt
```

### ‚úÖ Cierra los T√∫neles Cuando No los Uses

```bash
# Ctrl+C en cada terminal
# O cierra las terminales
```

## Recursos Adicionales

- [Sitio Oficial de LocalTunnel](https://localtunnel.github.io/www/)
- [Repositorio en GitHub](https://github.com/localtunnel/localtunnel)
- [Documentaci√≥n de ngrok](https://ngrok.com/docs) (alternativa)

---

:::info Versi√≥n
Esta documentaci√≥n es para TreeFlow v0.4 con bypass autom√°tico de LocalTunnel.
:::
